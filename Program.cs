using System;

using System.Collections.Generic;
using MixinSdk;
using MixinSdk.Bean;
using Org.BouncyCastle.Asn1.X509;
using Org.BouncyCastle.Crypto;
using Org.BouncyCastle.Crypto.Generators;
using Org.BouncyCastle.Crypto.Prng;
using Org.BouncyCastle.Security;
using Org.BouncyCastle.X509;

namespace mixin_labs_csharp_bot
{
    class Program
    {
    public static string ClientId     = "ddbf6591-f908-46c3-8101-cd19df31aa93";
    public static string ClientSecret = "ac67c0d80f9736039379f6cf1ba62f0d4ce47195386bf8750cf1bd00a8b4ca8c";
    public static string PinCode      = "585128";
    public static string SessionId    = "8ea48956-e9de-4775-9a49-4192f20acfd6";
    public static string PinToken     = "IUgOe7lQyLuEjrAzYgovKycYU5e9y+S0cwpamLWpmNJ4mwBFeG9l2fswU1imsOkQnhO3jA6L8l/AGC07G2JyrzEfaPT9WKBCuhlLm3UVGOWwsxU4Pa5qkafO7iSgPH+cK9Me5qpQ4H18R+zXkYuQNDz3DxuxKYtSGA8tph9+S1w=";
    public static string PrivateKey   =
    @"-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQCVn+sAxgq4zdDZdkWria2JhvveIfAeYjK7A2hyEerhSBJKeuk6
kbDeyFcqEBVPtIDOt5oDr8YLSXQGvw69u+OKJeEXaxkD/oo+AOUu+YhTrRPpP9uA
gMzDYRMXhVlbaQ9lZsZKXxWxY5g2QE4vi2FFPt0qJ5ZnRA1Evpr7J+G4DQIDAQAB
AoGAMYkVI1dte0tgZm5amHTnSA2xWxQ/S7/U7ccuD/3Qli7nJ1NT3bkYJlmLSfiz
JYUr08RDMA9EcL4rtIQSXExVAwZpWXQwNFY2HZYgYVxpKpYEagolpqnZXPdIuxGX
HBME7/VAla3crC2ncw7lzvlRRigU9rjhb/MBweJ76Mp/470CQQDuu659Zasa06L9
1h0LClNpRZOvkXmQ2rS8vxcrKU9BtG1GKI7nY4YzKD8fXe+bEmPHjpgCetkhlgYL
MUkPGMfHAkEAoHJUCcYsCX/ulJkogVu2rFUHh/Z7R658vcUi9F+Hsrkx/J+J0Aqu
7nZmLO19hv0P0dCJps+JgRWZSihZrt7JiwJBAJjkche1KSQBLn3KxsbvUgQ1nyPt
0yFGMEJBT6FAz5WQ6/rmtr7SKnxQ5jw8eNujp2uCky/jZXPxFOXOJrAYerkCQEtm
z0W0oxdnzuh4vcdlIYkFgL+Nv0vlnWvVjGLJzkzYqbwuAacKjkE01TnB9l8M6HVT
Co2hNN68Fsj6A4Oh4ZcCQEBswM6RS/X6DmsyX0o/hac/7FWjrlJu0IWx8mit0cEE
MTvukq+k3M9xkAhWuvXAEOUcxrFYE0vPWQIJUzYwNqk=
-----END RSA PRIVATE KEY-----";

        static void Main(string[] args)
        {
            Console.WriteLine("Hello World!");
            MixinApi mixinApi = new MixinApi();
            mixinApi.Init(ClientId,
                          ClientSecret,
                          SessionId,
                          PinToken,
                          PrivateKey);
            Console.WriteLine(mixinApi.VerifyPIN(PinCode).ToString());

            var kpgen = new RsaKeyPairGenerator();

            kpgen.Init(new KeyGenerationParameters(new SecureRandom(new CryptoApiRandomGenerator()), 1024));

            var keyPair = kpgen.GenerateKeyPair();
            AsymmetricKeyParameter privateKey = keyPair.Private;
            AsymmetricKeyParameter publicKey = keyPair.Public;

            SubjectPublicKeyInfo info = SubjectPublicKeyInfoFactory.CreateSubjectPublicKeyInfo(keyPair.Public);
            string pk = Convert.ToBase64String(info.GetDerEncoded());


            var user = mixinApi.APPUser("Csharp" + (new Random().Next() % 100) + " Cat", pk);
            Console.WriteLine(user);
        }
    }
}
